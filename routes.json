{
  "routes": [
    {
      "name": "gtm-ingest",
      "event_match": "*",
      "target_url": "{{N8N_WEBHOOK_URL}}",
      "methods": ["GET", "POST"],
      "priority": 1,
      "auth": {
        "type": "whitelist",
        "origins": ["https://tagmanager.google.com", "https://www.googletagmanager.com", "https://example.com"]
      }
    },
    {
      "name": "send-to-meta",
      "event_match": "purchase",
      "target_url": "https://graph.facebook.com/v18.0/{{META_PIXEL_ID}}/events",
      "methods": ["POST"],
      "template": "meta.json",
      "priority": 2,
      "auth": {
        "type": "apikey",
        "key": "{{MY_PRIVATE_KEY}}"
      },
      "headers": {
        "Authorization": "Bearer {{META_ACCESS_TOKEN}}"
      }
    },
    {
      "name": "send-to-ga4",
      "event_match": "purchase",
      "target_url": "https://www.google-analytics.com/mp/collect?measurement_id={{GA4_MEASUREMENT_ID}}&api_secret={{GA4_API_SECRET}}",
      "methods": ["POST"],
      "template": "ga4.json",
      "priority": 3,
      "multi": true,
      "auth": {
        "type": "whitelist",
        "origins": ["https://example.com", "https://www.example.com"]
      }
    },
    {
      "name": "catch-all-fallback",
      "event_match": "*",
      "target_url": "{{ZAPIER_WEBHOOK_URL}}",
      "methods": ["POST"],
      "fallback": true,
      "auth": {
        "type": "apikey",
        "key": "{{WEBHOOK_SECRET}}"
      }
    }
  ]
}
